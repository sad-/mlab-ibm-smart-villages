import gspread
from oauth2client.service_account import ServiceAccountCredentials
import nlu

scope = ['https://spreadsheets.google.com/feeds']
creds = ServiceAccountCredentials.from_json_keyfile_name('client_secret.json', scope)
client = gspread.authorize(creds)
sheet_read = client.open("Abuse Data (generated by Alex)").sheet1
sheet_write = client.open("Processed Information").sheet1


all_entries_vals = sheet_read.get_all_values()
i = 1
empty = False
last_col_index = len(all_entries_vals[0]) - 1
while i < 100 and not empty:
    row_to_add = all_entries_vals[i]
    print(row_to_add[7])
    language, keywords, entities, concepts, sentiment = nlu.analyze(row_to_add[7])
    row_to_add.append(language)
    row_to_add.append(keywords)
    row_to_add.append(entities)
    row_to_add.append(concepts)
    row_to_add.append(sentiment)
    sheet_write.insert_row(row_to_add, i + 1)
    i += 1
    if len(all_entries_vals[i][0]) == 0:
        empty = True
